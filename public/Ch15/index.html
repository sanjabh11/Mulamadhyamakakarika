<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 15 - Investigation of Essences</title>
    <link rel="stylesheet" href="styles.css">
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.150.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.150.0/examples/jsm/",
            "p5": "https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.js",
            "d3": "https://cdn.jsdelivr.net/npm/d3@7/+esm"
        }
    }
    </script>
    <!-- Load p5.js globally first -->
    <script src="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.js"></script>
</head>
<body>
    <div id="app">
        <header>
            <h1>Chapter 15 - Investigation of Essences</h1>
            <nav>
                <select id="verse-selector" aria-label="Select verse">
                    <option value="1">Verse 1: Essence and Causes</option>
                    <option value="2">Verse 2: Fabricated Essence</option>
                    <option value="3">Verse 3: Relational Identity</option>
                    <option value="4">Verse 4: Emptiness</option>
                    <option value="5">Verse 5: Non-things</option>
                    <option value="6">Verse 6: The Other</option>
                    <option value="7">Verse 7: Middle Way</option>
                    <option value="8">Verse 8: Impermanence</option>
                    <option value="9">Verse 9: Impossibility of Change</option>
                    <option value="10">Verse 10: Avoiding Extremes</option>
                    <option value="11">Verse 11: Eternalism and Nihilism</option>
                </select>
            </nav>
        </header>

        <main>
            <div id="content-wrapper">
                <div id="text-panel-side">
                    <div id="verse-content">
                        <div class="verse-details">
                            <h2 id="verse-title"></h2>
                            <div class="verse-text">
                                <h3>Original Verse</h3>
                                <p id="original-verse"></p>
                            </div>
                            <div class="concept">
                                <h3>Madhyamaka Concept</h3>
                                <p id="madhyamaka-concept"></p>
                            </div>
                            <div class="quantum-parallel">
                                <h3>Quantum Physics Parallel</h3>
                                <p id="quantum-parallel"></p>
                            </div>
                            <div class="explanation">
                                <h3>Accessible Explanation</h3>
                                <p id="accessible-explanation"></p>
                            </div>
                        </div>
                    </div>
                    <button id="toggle-panel" aria-label="Toggle explanation panel">
                        <svg viewBox="0 0 24 24" width="24" height="24">
                            <path d="M15 19l-7-7 7-7" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                </div>
                
                <div id="animation-container"></div>
            </div>

            <div id="control-panel">
                <button id="toggle-controls" aria-label="Toggle control panel">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z" fill="currentColor"></path>
                    </svg>
                </button>
                <div id="controls-content"></div>
            </div>
        </main>
    </div>

    <!-- Load modules in the correct order -->
    <script type="module" src="config.js"></script>
    <!-- We'll load all verses through main.js to avoid load order issues -->
    <script type="module" src="main.js"></script>
</body>
</html>